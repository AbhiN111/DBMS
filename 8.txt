create database library1;

use library1;

create table borrower(rollin int primary key, name varchar(30), dateofissue date, nameofbook varchar(30), status varchar(10));

insert into borrower values (101,'abc','2024-07-16','dbms','r'), (102,'abc1','2024-07-16','cn','i'), (103,'abc3','2024-07-18','toc','i'), (104,'abc4','2024-07-20','ds','i'), (105,'abc5','2024-07-23','daa','r'), (106,'nisha','2024-08-10','spm','r');

create table library_audit(rollin int, name char(10),dateofissue date, nameofbook char(10),status char, ts timestamp);

delimiter //
create trigger after_insert after insert on borrower for each row
begin
insert into library_audit values(new.rollin, new.name, new.dateofissue, new.nameofbook,new.status,current_timestamp);
end;
//

select * from borrower//

select * from library_audit //

insert into borrower values(107,'ada','2025-08-10','dbms','i')//

select * from borrower//

select * from library_audit //

create trigger after_delete after delete on borrower for each row
begin
insert into library_audit values(old.rollin, old.name, old.dateofissue, old.nameofbook,old.status,current_timestamp());
end;
//

select * from borrower//

select * from library_audit //

delete from borrower where rollin=105 //

select * from borrower//

select * from library_audit //

create trigger after_update after update on borrower for each row
begin
insert into library_audit values(new.rollin, new.name, new.dateofissue, new.nameofbook,new.status,current_timestamp());
end;
//

select * from borrower//

select * from library_audit //

update borrower set status='r' where borrower.rollin=104 //

select * from borrower//

select * from library_audit //









